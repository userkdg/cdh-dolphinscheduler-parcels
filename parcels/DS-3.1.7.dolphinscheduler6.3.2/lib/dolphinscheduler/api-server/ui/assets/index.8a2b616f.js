import{u as m,bq as b,b5 as _,a as x,bd as N,d as y,at as g,ba as C,c as r,ak as w}from"./index.ccaa682a.js";import{C as R}from"./index.76253dc2.js";import{M as I}from"./index.9532c9b8.js";import{u as S}from"./file.4d291ef4.js";import{o as E}from"./index.97c7c8f2.js";import{f as O}from"./common.0c468cf3.js";import{s as u}from"./index.module.b13963ba.js";import{N as j}from"./Form.b41344c3.js";import{N as a}from"./FormItem.6b297844.js";import{N as c}from"./Input.f12e0137.js";import{a as k}from"./Select.a0f44759.js";import{N as d}from"./Button.3394f0e3.js";import"./Card.915ef7d2.js";import"./use-rtl.d43d8217.js";import"./resolve-slot.d8d7b3cb.js";import"./index.7a579f81.js";import"./keysOf.10525521.js";import"./service.ae1ed8a7.js";import"./lodash.02988b15.js";import"./SettingOutlined.675e55ec.js";import"./PauseCircleOutlined.f81cacab.js";import"./CloseCircleOutlined.7f4d3411.js";import"./CheckCircleOutlined.b6132804.js";import"./EditOutlined.84f6aa5d.js";import"./index.15a20265.js";import"./format-length.a0cbed4d.js";import"./fade-in.cssr.ac08f6bb.js";import"./use-locale.ca4c738c.js";import"./Scrollbar.0dc514b7.js";import"./VResizeObserver.c3d2397d.js";import"./Suffix.584d00eb.js";import"./fade-in-scale-up.cssr.5995d390.js";import"./use-compitable.d1fd83c6.js";import"./Selection.57d091a8.js";import"./Popover.b48d5d17.js";import"./index.99c68204.js";import"./flatten.995f807f.js";import"./utils.381519a7.js";import"./next-frame-once.e5ee25e8.js";import"./is-browser.f4bc45cf.js";function q(t){const{t:o}=m(),e=b(),i=S();return{handleCreateFile:()=>{const l=e.currentRoute.value.params.id||-1,f=i.getCurrentDir||"/";t.fileFormRef.validate(async n=>{if(!n){await E({...t.fileForm,pid:l,currentDir:f}),window.$message.success(o("resource.file.success"));const s=l?"resource-file-subdirectory":"file";e.push({name:s,params:{id:l}})}})}}}const h=()=>({pid:-1,type:"FILE",suffix:"sh",fileName:"",description:"",content:"",currentDir:"/"});function U(){const{t}=m(),o=()=>{e.fileForm=Object.assign(N(e.fileForm),h())},e=_({fileFormRef:x(),fileForm:h(),rules:{fileName:{required:!0,trigger:["input","blur"],validator(){if(e.fileForm.fileName==="")return new Error(t("resource.file.enter_name_tips"));if(e.fileForm.fileName.endsWith(`.${e.fileForm.suffix}`))return new Error(t("resource.file.duplicate_suffix_tips"))}},suffix:{required:!0,trigger:["input","blur"],validator(){if(e.fileForm.suffix==="")return new Error(t("resource.file.enter_suffix_tips"))}},content:{required:!0,trigger:["input","blur"],validator(){if(e.fileForm.content==="")return new Error(t("resource.file.enter_content_tips"))}}}});return{state:e,resetForm:o}}function F(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!w(t)}const Ne=y({name:"ResourceFileCreate",setup(){var n;const t=b(),{state:o}=U(),{handleCreateFile:e}=q(o),i=O.map(s=>({key:s,label:s,value:s})),p=()=>{e()},l=()=>{const{id:s}=t.currentRoute.value.params,v=s?"resource-file-subdirectory":"file";t.push({name:v,params:{id:s}})},f=(n=g())==null?void 0:n.appContext.config.globalProperties.trim;return{fileSuffixOptions:i,handleFile:p,handleReturn:l,...C(o),trim:f}},render(){let t,o;const{t:e}=m();return r(R,{title:e("resource.file.file_details")},{default:()=>[r(j,{rules:this.rules,ref:"fileFormRef",class:u["form-content"]},{default:()=>[r(a,{label:e("resource.file.file_name"),path:"fileName"},{default:()=>[r(c,{allowInput:this.trim,value:this.fileForm.fileName,"onUpdate:value":i=>this.fileForm.fileName=i,placeholder:e("resource.file.enter_name_tips"),style:{width:"300px"},class:"input-file-name"},null)]}),r(a,{label:e("resource.file.file_format"),path:"suffix"},{default:()=>[r(k,{defaultValue:[this.fileForm.suffix],value:this.fileForm.suffix,"onUpdate:value":i=>this.fileForm.suffix=i,options:this.fileSuffixOptions,style:{width:"100px"},class:"select-file-format"},null)]}),r(a,{label:e("resource.file.description"),path:"description"},{default:()=>[r(c,{allowInput:this.trim,type:"textarea",value:this.fileForm.description,"onUpdate:value":i=>this.fileForm.description=i,placeholder:e("resource.file.enter_description_tips"),style:{width:"430px"},class:"input-description"},null)]}),r(a,{label:e("resource.file.file_content"),path:"content"},{default:()=>[r("div",{style:{width:"90%"}},[r(I,{value:this.fileForm.content,"onUpdate:value":i=>this.fileForm.content=i},null)])]}),r("div",{class:u["file-edit-content"]},[r("div",{class:u.submit},[r(d,{type:"info",size:"small",round:!0,onClick:this.handleFile,class:"btn-submit"},F(t=e("resource.file.save"))?t:{default:()=>[t]}),r(d,{type:"info",size:"small",text:!0,style:{marginLeft:"15px"},onClick:this.handleReturn,class:"btn-cancel"},F(o=e("resource.file.return"))?o:{default:()=>[o]})])])]})]})}});export{Ne as default};
