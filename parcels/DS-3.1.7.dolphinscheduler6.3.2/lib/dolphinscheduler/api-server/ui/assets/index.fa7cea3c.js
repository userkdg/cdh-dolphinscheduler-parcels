import{u as l,b5 as N,a as v,bd as w,bq as h,d as b,w as g,ba as C,c as o,bJ as V,ak as y}from"./index.ccaa682a.js";import{u as _}from"./index.cb24df24.js";import{v as j,u as S}from"./index.97c7c8f2.js";import{C as k}from"./index.76253dc2.js";import{M as x}from"./index.9532c9b8.js";import{s as c}from"./index.module.b13963ba.js";import{N as E}from"./Form.b41344c3.js";import{N as U}from"./FormItem.6b297844.js";import{N as m}from"./Space.f435ce00.js";import{N as f}from"./Button.3394f0e3.js";import{N as I}from"./Spin.6c6d001b.js";import"./service.ae1ed8a7.js";import"./lodash.02988b15.js";import"./Card.915ef7d2.js";import"./use-rtl.d43d8217.js";import"./resolve-slot.d8d7b3cb.js";import"./index.7a579f81.js";import"./keysOf.10525521.js";import"./format-length.a0cbed4d.js";import"./fade-in.cssr.ac08f6bb.js";import"./is-browser.f4bc45cf.js";import"./flatten.995f807f.js";import"./get-slot.7f666ba0.js";import"./use-compitable.d1fd83c6.js";const p=()=>({content:""});function O(){const{t:e}=l(),r=()=>{t.fileForm=Object.assign(w(t.fileForm),p())},t=N({fileFormRef:v(),fileForm:p(),rules:{content:{required:!0,trigger:["input","blur"],validator(){if(t.fileForm.content==="")return new Error(e("resource.file.enter_content_tips"))}}}});return{state:t,resetForm:r}}function q(e){const{t:r}=l(),t=h();return{getResourceView:i=>_(j({skipLineNum:0,limit:3e3},i),{alias:"",content:""}),handleUpdateContent:i=>{e.fileFormRef.validate(async a=>{a||(await S({...e.fileForm},i),window.$message.success(r("resource.file.success")),t.go(-1))})}}}function d(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!y(e)}const ie=b({name:"ResourceFileEdit",setup(){const e=V(),r=h(),t=e.name,s=Number(e.params.id),{state:n}=O(),{getResourceView:i,handleUpdateContent:a}=q(n),R=()=>{n.fileForm.content=u.state.value.content,a(s)},F=()=>{r.go(-1)},u=i(s);return g(()=>u.state.value.content,()=>n.fileForm.content=u.state.value.content),{componentName:t,resourceViewRef:u,handleReturn:F,handleFileContent:R,...C(n)}},render(){let e,r;const{t}=l();return o(k,{title:t("resource.file.file_details")},{default:()=>[this.resourceViewRef.isReady.value?o("div",{class:c["file-edit-content"]},[o("h2",null,[o("span",null,[this.resourceViewRef.state.value.alias])]),o(E,{rules:this.rules,ref:"fileFormRef",class:c["form-content"],disabled:this.componentName!=="resource-file-edit"},{default:()=>[o(U,{path:"content"},{default:()=>[o(x,{value:this.resourceViewRef.state.value.content,"onUpdate:value":s=>this.resourceViewRef.state.value.content=s},null)]}),o(m,null,{default:()=>[o(f,{type:"info",size:"small",text:!0,style:{marginRight:"15px"},onClick:this.handleReturn,class:"btn-cancel"},d(e=t("resource.file.return"))?e:{default:()=>[e]}),this.componentName==="resource-file-edit"&&o(f,{type:"info",size:"small",round:!0,onClick:()=>this.handleFileContent(),class:"btn-submit"},d(r=t("resource.file.save"))?r:{default:()=>[r]})]})]})]):o(m,{justify:"center"},{default:()=>[o(I,{show:!0},null)]})]})}});export{ie as default};
