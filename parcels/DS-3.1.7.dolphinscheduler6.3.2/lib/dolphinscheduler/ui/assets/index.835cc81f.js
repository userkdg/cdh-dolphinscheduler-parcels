import{bJ as b,u as y,b5 as v,a as u,d as T,e as w,w as C,ba as R,c as i}from"./index.ccaa682a.js";import{u as L}from"./index.cb24df24.js";import{l}from"./lodash.02988b15.js";import{a as M,b as P}from"./index.f226e50b.js";import{f}from"./index.15a20265.js";import S from"./state-card.56f270f7.js";import H from"./definition-card.1c2704ec.js";import{g as x}from"./DatePicker.34177339.js";import{s as V}from"./index.34de06b1.js";import{N as D,a as h}from"./Grid.8c7d7ba0.js";import"./service.ae1ed8a7.js";import"./Pie.1b7b50bc.js";import"./index.b6b88472.js";import"./index.76253dc2.js";import"./Card.915ef7d2.js";import"./use-rtl.d43d8217.js";import"./resolve-slot.d8d7b3cb.js";import"./index.7a579f81.js";import"./keysOf.10525521.js";import"./DataTable.f685dba1.js";import"./ArrowDown.c45c82c0.js";import"./format-length.a0cbed4d.js";import"./Button.3394f0e3.js";import"./is-browser.f4bc45cf.js";import"./Scrollbar.0dc514b7.js";import"./fade-in.cssr.ac08f6bb.js";import"./VResizeObserver.c3d2397d.js";import"./Checkbox.ff1b56b7.js";import"./RadioGroup.8830dbe4.js";import"./flatten.995f807f.js";import"./get-slot.7f666ba0.js";import"./Radio.0f909e72.js";import"./Popover.b48d5d17.js";import"./index.99c68204.js";import"./utils.381519a7.js";import"./use-compitable.d1fd83c6.js";import"./next-frame-once.e5ee25e8.js";import"./Suffix.584d00eb.js";import"./Dropdown.16d7f975.js";import"./Icon.808259cb.js";import"./ChevronRight.efc71575.js";import"./Selection.57d091a8.js";import"./use-locale.ca4c738c.js";import"./fade-in-scale-up.cssr.5995d390.js";import"./use-keyboard.db487137.js";import"./Ellipsis.31968545.js";import"./Tooltip.14e7654c.js";import"./Input.f12e0137.js";import"./Select.a0f44759.js";import"./Forward.6cc09413.js";import"./Bar.297befd4.js";function _(){const n=b(),{t:r}=y(),e=v({taskLoadingRef:u(!1)});return{getTaskState:t=>{if(e.taskLoadingRef)return;e.taskLoadingRef=!0;const{state:p}=L(M({startDate:t?f(t[0],"yyyy-MM-dd HH:mm:ss"):"",endDate:t?f(t[1],"yyyy-MM-dd HH:mm:ss"):"",projectCode:Number(n.params.projectCode)}).then(a=>{const s=a.taskCountDtos.map((o,d)=>({state:r("home."+l.exports.toLower(o.taskStateType)),number:o.count})),c=a.taskCountDtos.map(o=>({value:o.count,name:r("home."+l.exports.toLower(o.taskStateType))}));return e.taskLoadingRef=!1,{table:s,chart:c}}),{table:[],chart:[]});return p},taskVariables:e}}function N(){const n=b(),{t:r}=y(),e=v({processLoadingRef:u(!1)});return{getProcessState:t=>{if(e.processLoadingRef)return;e.processLoadingRef=!0;const{state:p}=L(P({startDate:t?f(t[0],"yyyy-MM-dd HH:mm:ss"):"",endDate:t?f(t[1],"yyyy-MM-dd HH:mm:ss"):"",projectCode:Number(n.params.projectCode)}).then(a=>{const s=a.taskCountDtos.map((o,d)=>({state:r("home."+l.exports.toLower(o.taskStateType)),number:o.count})),c=a.taskCountDtos.map(o=>({value:o.count,name:r("home."+l.exports.toLower(o.taskStateType))}));return e.processLoadingRef=!1,{table:s,chart:c}}),{table:[],chart:[]});return p},processVariables:e}}const Vt=T({name:"workflow-monitor",setup(){const{t:n,locale:r}=y(),e=u([x(V()),Date.now()]),m=u(),t=u(),{getTaskState:p,taskVariables:a}=_(),{getProcessState:s,processVariables:c}=N(),o=k=>{m.value=p(k)},d=k=>{t.value=s(k)},g=()=>{m.value=p(e.value)||m.value,t.value=s(e.value)||t.value};return w(()=>{g()}),C(()=>r.value,()=>g()),{t:n,dateRef:e,handleTaskDate:o,handleProcessDate:d,taskStateRef:m,processStateRef:t,...R(a),...R(c)}},render(){const{t:n,dateRef:r,handleTaskDate:e,handleProcessDate:m,taskLoadingRef:t,processLoadingRef:p}=this;return i("div",null,[i(D,{"x-gap":12,cols:2},{default:()=>[i(h,null,{default:()=>{var a,s;return[i(S,{title:n("home.task_state_statistics"),date:r,tableData:(a=this.taskStateRef)==null?void 0:a.value.table,chartData:(s=this.taskStateRef)==null?void 0:s.value.chart,onUpdateDatePickerValue:e,loadingRef:t},null)]}}),i(h,null,{default:()=>{var a,s;return[i(S,{title:n("home.process_state_statistics"),date:r,tableData:(a=this.processStateRef)==null?void 0:a.value.table,chartData:(s=this.processStateRef)==null?void 0:s.value.chart,onUpdateDatePickerValue:m,loadingRef:p},null)]}})]}),i(D,{cols:1,style:"margin-top: 12px;"},{default:()=>[i(h,null,{default:()=>[i(H,{title:n("home.process_definition_statistics")},null)]})]})])}});export{Vt as default};
