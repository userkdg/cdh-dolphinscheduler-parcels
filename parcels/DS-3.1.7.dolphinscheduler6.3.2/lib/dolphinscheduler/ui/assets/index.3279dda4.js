import{C as b}from"./index.76253dc2.js";import{d as N,u as C,a as l,e as A,w as O,c as a,ak as j,bq as $}from"./index.ccaa682a.js";import E from"./use-tree.ad3a8266.js";import{n as w}from"./index.ea22358f.js";import{l as v}from"./lodash.02988b15.js";import{t as I}from"./common.0c468cf3.js";import{A as P}from"./ArrowLeftOutlined.f7bcb06a.js";import{N as R}from"./Image.bab30061.js";import{N as _}from"./Button.3394f0e3.js";import{N as G}from"./Icon.808259cb.js";import{N as H}from"./FormItem.6b297844.js";import{a as L}from"./Select.a0f44759.js";import{N as x}from"./Space.f435ce00.js";import"./Card.915ef7d2.js";import"./use-rtl.d43d8217.js";import"./resolve-slot.d8d7b3cb.js";import"./index.7a579f81.js";import"./keysOf.10525521.js";import"./index.b6b88472.js";import"./Grid.8c7d7ba0.js";import"./utils.381519a7.js";import"./is-browser.f4bc45cf.js";import"./VResizeObserver.c3d2397d.js";import"./flatten.995f807f.js";import"./get-slot.7f666ba0.js";import"./next-frame-once.e5ee25e8.js";import"./service.ae1ed8a7.js";import"./SettingOutlined.675e55ec.js";import"./PauseCircleOutlined.f81cacab.js";import"./CloseCircleOutlined.7f4d3411.js";import"./CheckCircleOutlined.b6132804.js";import"./EditOutlined.84f6aa5d.js";import"./index.15a20265.js";import"./fade-in.cssr.ac08f6bb.js";import"./fade-in-scale-up.cssr.5995d390.js";import"./use-locale.ca4c738c.js";import"./Scrollbar.0dc514b7.js";import"./index.99c68204.js";import"./Tooltip.14e7654c.js";import"./Popover.b48d5d17.js";import"./format-length.a0cbed4d.js";import"./use-compitable.d1fd83c6.js";import"./Selection.57d091a8.js";import"./Suffix.584d00eb.js";const M="_content_oganr_17",U="_card_oganr_20",B="_header_oganr_23",F="_right_oganr_29",m={content:M,card:U,header:B,right:F};function K(o){return typeof o=="function"||Object.prototype.toString.call(o)==="[object Object]"&&!j(o)}const Rt=N({name:"WorkflowDefinitionTiming",setup(){const o=$(),{t:r,locale:u}=C(),g=l([{label:"25",value:25},{label:"50",value:50},{label:"75",value:75},{label:"100",value:100}]),p=l(Number(o.currentRoute.value.params.projectCode)),n=l(Number(o.currentRoute.value.params.definitionCode)),c=l([]),i=l(),d=l([{taskType:"SHELL",color:"#646464",image:"/dolphinscheduler/ui/images/task-icons/shell.png"},{taskType:"SUB_PROCESS",color:"#4295DA",image:"/dolphinscheduler/ui/images/task-icons/sub_process.png"},{taskType:"PROCEDURE",color:"#545CC6",image:"/dolphinscheduler/ui/images/task-icons/procedure.png"},{taskType:"SQL",color:"#8097A0",image:"/dolphinscheduler/ui/images/task-icons/sql.png"},{taskType:"SPARK",color:"#a16435",image:"/dolphinscheduler/ui/images/task-icons/spark.png"},{taskType:"FLINK",color:"#d68f5b",image:"/dolphinscheduler/ui/images/task-icons/flink.png"},{taskType:"MR",color:"#A1A5C9",image:"/dolphinscheduler/ui/images/task-icons/mr.png"},{taskType:"PYTHON",color:"#60BCD5",image:"/dolphinscheduler/ui/images/task-icons/python.png"},{taskType:"DEPENDENT",color:"#60BCD5",image:"/dolphinscheduler/ui/images/task-icons/dependent.png"},{taskType:"HTTP",color:"#7f3903",image:"/dolphinscheduler/ui/images/task-icons/http.png"},{taskType:"DATAX",color:"#75CC71",image:"/dolphinscheduler/ui/images/task-icons/datax.png"},{taskType:"PIGEON",color:"#5EC459",image:"/dolphinscheduler/ui/images/task-icons/pigeon.png"},{taskType:"SQOOP",color:"#f98b3d",image:"/dolphinscheduler/ui/images/task-icons/sqoop.png"},{taskType:"CONDITIONS",color:"#b99376",image:"/dolphinscheduler/ui/images/task-icons/conditions.png"},{taskType:"SWITCH",color:"#ff6f00",image:"/dolphinscheduler/ui/images/task-icons/switch.png"},{taskType:"SEATUNNEL",color:"#8c8c8f",image:"/dolphinscheduler/ui/images/task-icons/seatunnel.png"},{taskType:"DINKY",color:"#d69f5b",image:"/dolphinscheduler/ui/images/task-icons/dinky.png"},{taskType:"DAG",color:"#bbdde9"},{taskType:"FLINK_STREAM",color:"#d68f5b",image:"/dolphinscheduler/ui/images/task-icons/flink.png"}]),D=()=>{i.value=Object.entries(I(r)).map(([t,e])=>({state:t,value:e.desc,color:e.color}))},k=(t,e)=>{e.children=[],t==null||t.children.map(s=>{const T={};k(s,T),e.children.push(T)}),e.name=t.name,e.value=t.name==="DAG"?"DAG":t==null?void 0:t.type;const h=v.exports.find(d.value,{taskType:e.value});if(h&&(e.itemStyle={color:h.color},e.name!=="DAG")){let s=null;t.instances&&t.instances.length>0&&t.instances[0].state&&(s=v.exports.find(i.value,{state:t.instances[0].state})),e.label={show:!0,formatter:[`{name|${r("project.task.task_name")}:${e.name}}`,`{type|${r("project.task.task_type")}:${h.taskType}}`,s?`{state|${r("project.workflow.task_state")}: ${s.value}}`:""].join(`
`),rich:{type:{lineHeight:20,align:"left"},name:{lineHeight:20,align:"left"},state:{lineHeight:20,align:"left",color:s?s.color:"black"}}}}},f=async t=>{if(p.value&&n){const e=await w(p.value,n.value,{limit:t});c.value=[{name:"DAG",value:"DAG"}],k(e,c.value[0])}},S=t=>{t&&f(t)},y=()=>{D(),f(25)};return A(()=>{y()}),O(()=>u.value,()=>{y()}),{chartData:c,options:g,onSelectChange:S,taskTypeNodeOptions:d}},render(){let o;const{chartData:r,options:u,onSelectChange:g,taskTypeNodeOptions:p}=this,{t:n}=C(),c=$();return a("div",{class:m.content},[a(b,{class:m.card},{default:()=>[a("div",{class:m.header},[a(_,{type:"primary",onClick:()=>c.go(-1)},{default:()=>[a(G,null,{default:()=>[a(P,null,null)]})]}),a(H,{size:"small",class:m.right,showFeedback:!1,labelPlacement:"left",label:n("project.workflow.tree_limit")},{default:()=>[a(L,{size:"small",defaultValue:25,onUpdateValue:g,options:u},null)]})])]}),a(b,{title:n("project.workflow.tree_view")},{default:()=>[a(x,{align:"center"},K(o=p.filter(i=>i.image).map((i,d)=>a(_,{text:!0,size:"tiny",color:i.color},{default:()=>[a(R,{width:"20",src:i.image},null),i.taskType]})))?o:{default:()=>[o]}),a(E,{chartData:r},null)]})])}});export{Rt as default};
