import{d as k,b7 as b,b8 as C,b9 as _,b5 as N,a as m,u as j,e as y,w as W,ba as v,c as t,bJ as F,t as O}from"./index.ccaa682a.js";import{u as w}from"./index.cb24df24.js";import{s as p}from"./service.ae1ed8a7.js";import{C as D}from"./index.76253dc2.js";import R from"./Graph.bfb015cf.js";import{R as S}from"./index.ef517cfe.js";import{R as x}from"./ReloadOutlined.b52e57ea.js";import{N as u}from"./Tooltip.14e7654c.js";import{N as L}from"./Space.f435ce00.js";import{a as B}from"./Select.a0f44759.js";import{N as f}from"./Button.3394f0e3.js";import{N as d}from"./Icon.808259cb.js";import"./lodash.02988b15.js";import"./Card.915ef7d2.js";import"./use-rtl.d43d8217.js";import"./resolve-slot.d8d7b3cb.js";import"./index.7a579f81.js";import"./keysOf.10525521.js";import"./index.b6b88472.js";import"./Popover.b48d5d17.js";import"./index.99c68204.js";import"./flatten.995f807f.js";import"./Scrollbar.0dc514b7.js";import"./fade-in.cssr.ac08f6bb.js";import"./VResizeObserver.c3d2397d.js";import"./utils.381519a7.js";import"./format-length.a0cbed4d.js";import"./use-compitable.d1fd83c6.js";import"./next-frame-once.e5ee25e8.js";import"./is-browser.f4bc45cf.js";import"./get-slot.7f666ba0.js";import"./fade-in-scale-up.cssr.5995d390.js";import"./use-locale.ca4c738c.js";import"./Selection.57d091a8.js";import"./Suffix.584d00eb.js";const z={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},q=_("path",{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 0 0 0 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3c7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176s176-78.8 176-176s-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112s112 50.1 112 112s-50.1 112-112 112z",fill:"currentColor"},null,-1),$=[q],E=k({name:"EyeOutlined",render:function(l,s){return b(),C("svg",z,$)}});function M(e){return p({url:`/projects/${e.projectCode}/lineages/list`,method:"get"})}function I(e){return p({url:`/projects/${e.projectCode}/lineages/query-by-name`,method:"get"})}function V(e,l){return p({url:`/projects/${l.projectCode}/lineages/${e.workFlowCode}`,method:"get"})}function A(){const e=N({workflowOptions:[],workflow:m(null),seriesData:[],labelShow:m(!0),links:[]}),l=r=>{e.seriesData=[],e.links=[],e.seriesData=r.workFlowList.map(o=>({name:o.workFlowName,id:o.workFlowCode,...o})),e.links=r.workFlowRelationList.map(o=>({source:String(o.sourceWorkFlowCode),target:String(o.targetWorkFlowCode)}))};return{variables:e,getWorkflowName:r=>{const{state:o}=w(I({projectCode:r}).then(n=>{e.workflowOptions=n.map(i=>({label:i.workFlowName,value:i.workFlowCode}))}),{});return o},getOneWorkflow:(r,o)=>{const{state:n}=w(V({workFlowCode:r},{projectCode:o}).then(i=>{l(i)}),{});return n},getWorkflowList:r=>{const{state:o}=w(M({projectCode:r}).then(n=>{l(n)}),{});return o}}}const ye=k({name:"workflow-relation",setup(){const{t:e,locale:l}=j(),s=F(),{variables:a,getWorkflowName:c,getOneWorkflow:r,getWorkflowList:o}=A();y(()=>{o(Number(s.params.projectCode)),c(Number(s.params.projectCode))});const n=()=>{a.seriesData=[],a.workflow&&a.workflow!==0?r(Number(a.workflow),Number(s.params.projectCode)):o(Number(s.params.projectCode))},i=({node:h,option:g})=>O(u,null,{trigger:()=>h,default:()=>g.label});return W(()=>[a.workflow,a.labelShow,l.value],()=>{n()}),{t:e,handleResetDate:n,...v(a),renderOption:i}},render(){const{t:e,handleResetDate:l}=this;return this.seriesData.length===0&&t(S,{title:e("project.workflow.workflow_relation_no_data_result_title"),description:e("project.workflow.workflow_relation_no_data_result_desc"),status:"info",size:"medium"},null)||this.seriesData.length>0&&t(D,{title:e("project.workflow.workflow_relation")},{default:()=>Object.keys(this.seriesData).length>0&&t(R,{seriesData:this.seriesData,labelShow:this.labelShow,links:this.links},null),"header-extra":()=>t(L,null,{default:()=>[t(B,{clearable:!0,filterable:!0,style:{width:"300px"},placeholder:e("project.workflow.workflow_name"),options:this.workflowOptions,value:this.workflow,"onUpdate:value":s=>this.workflow=s,renderOption:this.renderOption},null),t(u,{trigger:"hover"},{default:()=>e("project.workflow.refresh"),trigger:()=>t(f,{strong:!0,secondary:!0,circle:!0,type:"info",onClick:l},{default:()=>[t(d,null,{default:()=>[t(x,null,null)]})]})}),t(u,{trigger:"hover"},{default:()=>e("project.workflow.show_hide_label"),trigger:()=>t(f,{strong:!0,secondary:!0,circle:!0,type:"info",onClick:()=>this.labelShow=!this.labelShow},{default:()=>[t(d,null,{default:()=>[t(E,null,null)]})]})})]})})}});export{ye as default};
