import{d as F,u as P,at as G,e as I,w as U,ba as p,c as t,ak as O}from"./index.ccaa682a.js";import{M as V}from"./index.c665300e.js";import{useStart as M}from"./use-start.b17293db.js";import{P as h}from"./PlusCircleOutlined.53e873cd.js";import{D as R}from"./DeleteOutlined.b64cb1c2.js";import{N as D}from"./Form.b41344c3.js";import{N as s}from"./FormItem.6b297844.js";import{a as l}from"./Select.a0f44759.js";import{N as u}from"./Button.3394f0e3.js";import{N as m}from"./Icon.808259cb.js";import{N as f}from"./Space.f435ce00.js";import{N as T}from"./Input.f12e0137.js";import{N as W}from"./Switch.97f1d4b9.js";import"./index.c1fd473c.js";import"./keysOf.10525521.js";import"./Card.915ef7d2.js";import"./use-rtl.d43d8217.js";import"./resolve-slot.d8d7b3cb.js";import"./index.7a579f81.js";import"./index.99c68204.js";import"./flatten.995f807f.js";import"./Scrollbar.0dc514b7.js";import"./fade-in.cssr.ac08f6bb.js";import"./VResizeObserver.c3d2397d.js";import"./fade-in-scale-up.cssr.5995d390.js";import"./utils.381519a7.js";import"./is-browser.f4bc45cf.js";import"./index.f525e57e.js";import"./service.ae1ed8a7.js";import"./lodash.02988b15.js";import"./index.ea22358f.js";import"./index.db4740c8.js";import"./index.8f0bc55d.js";import"./index.10c5a06c.js";import"./format-length.a0cbed4d.js";import"./use-locale.ca4c738c.js";import"./use-compitable.d1fd83c6.js";import"./Selection.57d091a8.js";import"./Popover.b48d5d17.js";import"./next-frame-once.e5ee25e8.js";import"./Suffix.584d00eb.js";import"./get-slot.7f666ba0.js";function E(a){return typeof a=="function"||Object.prototype.toString.call(a)==="[object Object]"&&!O(a)}const A={row:{type:Object,default:{}},show:{type:Boolean,default:!1},taskCode:{type:String}},Gt=F({name:"task-definition-start",props:A,emits:["update:show","update:row","updateList"],setup(a,o){var d;const{t:r}=P(),{variables:e,handleStartDefinition:n,getWorkerGroups:k,getAlertGroups:w,getEnvironmentList:v,getStartParamsList:g}=M(o),S=()=>[{value:"NONE",label:r("project.task.none_send")},{value:"SUCCESS",label:r("project.task.success_send")},{value:"FAILURE",label:r("project.task.failure_send")},{value:"ALL",label:r("project.task.all_send")}],b=()=>{o.emit("update:show")},y=()=>{n(a.row.taskCode)},N=()=>{e.startForm.environmentCode=null},_=()=>{e.startState.startParamsList.push({prop:"",value:""})},C=(i,c)=>{e.startState.startParamsList[i].prop=c[0],e.startState.startParamsList[i].value=c[1]},L=i=>{e.startState.startParamsList.splice(i,1)},j=(d=G())==null?void 0:d.appContext.config.globalProperties.trim;return I(()=>{k(),w(),v()}),U(()=>a.show,()=>{a.show&&g(a.row.processDefinitionCode)}),{t:r,hideModal:b,handleStart:y,updateWorkerGroup:N,removeStartParams:L,addStartParams:_,updateParamsList:C,generalWarningTypeListOptions:S,...p(e),...p(e.startState),...p(a),trim:j}},render(){let a;const{t:o}=this;return t(V,{show:this.show,title:o("project.task.set_parameters_before_starting"),onCancel:this.hideModal,onConfirm:this.handleStart,confirmLoading:this.saving},{default:()=>[t(D,{ref:"startFormRef",model:this.startForm},{default:()=>[t(s,{label:o("project.task.task_name"),path:"task_name"},{default:()=>[t("div",{title:this.row.taskName},[this.row.taskName])]}),t(s,{label:o("project.task.notification_strategy"),path:"warningType"},{default:()=>[t(l,{options:this.generalWarningTypeListOptions(),value:this.startForm.warningType,"onUpdate:value":r=>this.startForm.warningType=r},null)]}),t(s,{label:o("project.task.worker_group"),path:"workerGroup"},{default:()=>[t(l,{options:this.workerGroups,onUpdateValue:this.updateWorkerGroup,value:this.startForm.workerGroup,"onUpdate:value":r=>this.startForm.workerGroup=r},null)]}),t(s,{label:o("project.task.environment_name"),path:"environmentCode"},{default:()=>[t(l,{options:this.environmentList.filter(r=>{var e;return(e=r.workerGroups)==null?void 0:e.includes(this.startForm.workerGroup)}),value:this.startForm.environmentCode,"onUpdate:value":r=>this.startForm.environmentCode=r,clearable:!0},null)]}),t(s,{label:o("project.task.alarm_group"),path:"warningGroupId"},{default:()=>[t(l,{options:this.alertGroups,placeholder:o("project.task.please_choose"),value:this.startForm.warningGroupId,"onUpdate:value":r=>this.startForm.warningGroupId=r,clearable:!0},null)]}),t(s,{label:o("project.task.startup_parameter"),path:"startup_parameter"},{default:()=>[this.startParamsList.length===0?t(u,{text:!0,type:"primary",onClick:this.addStartParams},{default:()=>[t(m,null,{default:()=>[t(h,null,null)]})]}):t(f,{vertical:!0},E(a=this.startParamsList.map((r,e)=>t(f,{key:Date.now()+e},{default:()=>[t(T,{allowInput:this.trim,pair:!0,separator:":",placeholder:["prop","value"],defaultValue:[r.prop,r.value],onUpdateValue:n=>this.updateParamsList(e,n)},null),t(u,{text:!0,type:"error",onClick:()=>this.removeStartParams(e),class:"btn-delete-custom-parameter"},{default:()=>[t(m,null,{default:()=>[t(R,null,null)]})]}),t(u,{text:!0,type:"primary",onClick:this.addStartParams,class:"btn-create-custom-parameter"},{default:()=>[t(m,null,{default:()=>[t(h,null,null)]})]})]})))?a:{default:()=>[a]})]}),t(s,{label:o("project.task.whether_dry_run"),path:"dryRun"},{default:()=>[t(W,{checkedValue:1,uncheckedValue:0,value:this.startForm.dryRun,"onUpdate:value":r=>this.startForm.dryRun=r},null)]})]})]})}});export{Gt as default};
